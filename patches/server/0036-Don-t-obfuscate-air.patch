From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ivan Pekov <ivan@mrivanplays.com>
Date: Tue, 18 Aug 2020 07:55:21 +0300
Subject: [PATCH] Don't obfuscate air

Thanks stonar96

diff --git a/src/main/java/com/destroystokyo/paper/antixray/ChunkPacketBlockControllerAntiXray.java b/src/main/java/com/destroystokyo/paper/antixray/ChunkPacketBlockControllerAntiXray.java
index 5a69dde15f88ac051d25eaec4e07d1b030319c48..4f9bebb666fd3b31ee7c1c52666f34ede0fe42ec 100644
--- a/src/main/java/com/destroystokyo/paper/antixray/ChunkPacketBlockControllerAntiXray.java
+++ b/src/main/java/com/destroystokyo/paper/antixray/ChunkPacketBlockControllerAntiXray.java
@@ -82,7 +82,7 @@ public final class ChunkPacketBlockControllerAntiXray extends ChunkPacketBlockCo
         for (String id : toObfuscate) {
             Block block = IRegistry.BLOCK.getOptional(new MinecraftKey(id)).orElse(null);
 
-            if (block != null) {
+            if (block != null && !block.getBlockData().isAir()) { // Yatopia - don't obfuscate air - causes unnecessary block updates to fail in the void
                 obfuscateGlobal[ChunkSection.GLOBAL_PALETTE.getOrCreateIdFor(block.getBlockData())] = true;
             }
         }
